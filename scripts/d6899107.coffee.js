(function(){L.CanvasTileLayer=L.GridLayer.extend({options:{minZoom:0,maxZoom:18,zoomOffset:0,nativeZoom:15},initialize:function(a){return a=L.setOptions(this,a),a.detectRetina&&L.Browser.retina&&a.maxZoom>0?(a.tileSize=Math.floor(a.tileSize/2),a.zoomOffset++,a.minZoom=Math.max(0,a.minZoom),a.maxZoom--):void 0},createTile:function(a,b){var c;return c=document.createElement("canvas"),c.coords=a,this._drawCanvasTile(c,function(){return b(!1,c)}),c.alt="",c},_getTileSize:function(){var a,b,c,d;return a=this._map,b=this.options,c=a.getZoom()+b.zoomOffset,d=b.nativeZoom,Math.round(a.getZoomScale(c)/a.getZoomScale(d)*b.tileSize)}}),L.canvasTileLayer=function(a){return new L.CanvasTileLayer(a)}}).call(this),function(){var a,b,c;c=Long.fromString("5DEECE66D",!1,16),a=Long.fromString("B",!1,16),b=Long.fromInt(1).shiftLeft(48).subtract(1),window.JavaRand=function(){function d(a){this.state=a.xor(c).and(b)}return d.prototype.next=function(d){return this.state=this.state.multiply(c).add(a).and(b),this.state.shiftRightUnsigned(48-d).toInt()},d.prototype.nextInt=function(a){var b,c;if(null!=a){if((a&-a)===a)return Long.fromInt(this.next(31)).multiply(a).shiftRight(31).toInt();for(;;)if(b=this.next(31),c=b%a,!(0>b-c+(a-1)))break;return c}return this.next(32)},d}()}.call(this),function(){window.Cache=function(){function a(a,b){this.provider=a,this.max_entries=b,this.tiles={},this.lru=[]}return a.prototype.get=function(a,b){var c;return null==b&&(b=null),c=JSON.stringify(a),this.tiles[c]?(this.lru=_.without(this.lru,c),this.lru.push(c),b?b(null,this.tiles[c]):this.tiles[c]):b?this.provider(a,function(a){return function(d,e){return d?b(d):(a.tiles[c]=e,a.lru.push(c),a.lru.length>a.max_entries&&(a.tiles[a.lru[0]]=null,a.lru=a.lru.slice(1)),b(null,e))}}(this)):void 0},a}()}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};window.BiomeTileLayer=function(){function b(b){this.tileProvider=a(this.tileProvider,this),this._drawCanvasTile=a(this._drawCanvasTile,this),this.layer=L.canvasTileLayer(b),this.update_callback=b.update_callback,this.layer._drawCanvasTile=this._drawCanvasTile,this.cache=new Cache(this.tileProvider,75),this.worker_funcs={init:function(){var a,b,c,d;for(importScripts("scripts/9c50467c.worker.js"),self.PerlinSimplex.noiseDetail(3,.5),this.parabolic=new Float32Array(25),d=[],b=c=-2;2>c;b=++c)d.push(function(){var c,d;for(d=[],a=c=-2;2>c;a=++c)d.push(this.parabolic[a+2+5*(b+2)]=10/Math.sqrt(b*b+a*a+.2));return d}.call(this));return d},calc_pixels:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;for(e=new Uint8Array(a.biome_data),j=a.c_x,k=a.c_y,o=new Float32Array(264196),v=self.PerlinSimplex.noise,g=self.biome_map,console.time("b"),N=O=0;514>O;N=++O)for(M=P=0;514>P;M=++P){for(B=M+2+518*(N+2),C=M+514*N,f=g[e[B]],h=f.offset,z=0,G=0,K=0,J=Q=-2;2>Q;J=++Q)for(I=R=-2;2>R;I=++R)u=g[e[M+2+I+518*(N+2+J)]],q=u.offset,r=u.scale,D=this.parabolic[I+2+5*(J+2)]/(q+2),q>h&&(D/=2),G+=r*D,z+=q*D,K+=D;G/=K,z/=K,c=(4*z-1)/8,d=8.5*c/8,i=8.5+4*d,l=8*i,o[C]=l+G*(2*v((M-1+512*j)/32,(N-1+512*k)/32)-1)}for(console.timeEnd("b"),console.time("d"),n=new Float32Array(262144),N=S=0;512>S;N=++S)for(M=T=0;512>T;M=++T)s=M+1,t=N+1,w=o[s-1+514*t]-o[s+1+514*t],x=o[s+514*(t+1)]-o[s+514*(t-1)],y=2,p=w*w+x*x+y*y,p>0&&(p=1/Math.sqrt(p),w*=p,x*=p,y*=p),l=-.5773*w+.5773*x+.5773*y,n[M+512*N]=l>0?l:0;for(console.timeEnd("d"),console.time("w"),F=new Uint8ClampedArray(1048576),N=U=0;512>U;N=++U)for(M=V=0;512>V;M=++V)A=M+512*N,f=g[e[M+3+518*(N+3)]],i=f.colour,m=n[A],F[4*A]=i[0]*Math.min(1,.5*m+.5),F[4*A+1]=i[1]*Math.min(1,.5*m+.5),F[4*A+2]=i[2]*Math.min(1,.5*m+.5),F[4*A+3]=255;for(console.timeEnd("w"),H=new Uint8Array(268324),N=W=0;518>W;N=++W)for(M=X=0;518>X;M=++X)if(!H[M+518*N])for(L=[[M,N]];L.length;)E=L.pop();return b({pixels:F,biomes:e},[F.buffer,e.buffer])}},this.workers=cw(this.worker_funcs,4)}return b.prototype.remove=function(){return this.workers.close()},b.prototype._drawCanvasTile=function(a,b){var c,d,e;return e=a.getContext("2d"),a.width=512,a.height=512,c=a.coords.x,d=a.coords.y,this.cache.get({c_x:c,c_y:d},function(c){return function(d,f){var g,h,i,j,k;if(g=f[0],k=f[1],i=e.createImageData(a.width,a.height),h=i.data,h.set)h.set(k);else for(j=h.length-1;j--;)h[j]=k[j];return e.putImageData(i,0,0),b(!1,a),c.update_callback?c.update_callback():void 0}}(this))},b.prototype.request=function(a,b,c){var d;return d=new XMLHttpRequest,d.open("GET",a,!0),d.responseType="arraybuffer",d.onreadystatechange=function(){return this.readyState===this.DONE?200===this.status&&null!==this.response?b(new Uint8Array(this.response)):c():void 0},d.send()},b.prototype.tileProvider=function(a,b){return this.request("http://data.mineatlas.com/data?seed="+this.seed.toString()+"&type=Default&x="+a.c_x+"&y="+a.c_y,function(c){return function(d){var e;return e={biome_data:d.buffer,c_x:a.c_x,c_y:a.c_y},c.workers.calc_pixels(e,[e.biome_data]).then(function(a){return b(null,[new Uint8Array(a.biomes),new Uint8ClampedArray(a.pixels)])})}}(this),function(){return console.log("error"),b("error")})},b}()}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};window.MineMap=function(){function c(c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u;for(this.el=c,this.seed=d,this.features=e,this.slimeProvider=a(this.slimeProvider,this),this.featureProvider=a(this.featureProvider,this),this.setLayerState=a(this.setLayerState,this),this.tileUnload=a(this.tileUnload,this),this.tileLoad=a(this.tileLoad,this),this.removeTileFeature=a(this.removeTileFeature,this),this.addTileFeature=a(this.addTileFeature,this),this.setStaticFeature=a(this.setStaticFeature,this),this.biomeAtBiomeCoords=a(this.biomeAtBiomeCoords,this),this.biomeAt=a(this.biomeAt,this),this.tileCoords=a(this.tileCoords,this),this.mc_coords=a(this.mc_coords,this),this.map_coords=a(this.map_coords,this),this.map=L.map(this.el.get(0),{crs:L.CRS.Simple,maxZoom:18,minZoom:14,bounceAtZoomLimits:!1}),this.map.setView([f,g],h),this.map.on("click",function(a){return function(b){var c;return c=a.mc_coords(b.latlng),console.log("/tp "+c.x+" 100 "+c.y)}}(this)),this.biomeTiles=new BiomeTileLayer({unloadInvisibleTiles:!0,updateWhenIdle:!0,continuousWorld:!0}),this.biomeTiles.seed=this.seed,this.biomeTiles.layer.addTo(this.map),this.biomeTiles.layer.on("tileunload",this.tileUnload),this.biomeTiles.layer.on("tileload",this.tileLoad),this.featureCache=new Cache(this.featureProvider,75),this.slimeCache=new Cache(this.slimeProvider,75),k={shadowUrl:"markers/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[0,-36],shadowSize:[41,41],shadowAnchor:[13,41]},this.markers={},this.static_features=["Player","Strongholds","Spawn"],this.feature_makers={},this.feature_layer_state={},r=this.features,m=function(a){return function(){var b,c;return b="markers/"+i.icon,c=i.name,c="Player"===c?c:c.slice(0,-1),a.feature_makers[i.name]=function(d){return L.marker(a.map_coords(d),{title:c,icon:L.icon(_.extend({iconUrl:b},k)),opacity:.75,riseOnHover:!0}).bindPopup(""+c+"<br>x:"+d.x+" y:"+d.y)}}}(this),n=0,p=r.length;p>n;n++)i=r[n],this.feature_layer_state[i.name]=i.active,this.markers[i.name]=L.layerGroup(),m();this.feature_makers["Slime Chunks"]=function(a){return function(b){return L.rectangle([a.map_coords(b),a.map_coords({x:b.x+16,y:b.y+16})],{color:"#00FF00",weight:1,clickable:!1,opacity:.3})}}(this),s=this.markers;for(l in s)j=s[l],this.map.addLayer(j);for(t=this.features,o=0,q=t.length;q>o;o++)i=t[o],u=i.name,b.call(this.static_features,u)>=0&&!i.active&&this.map.removeLayer(this.markers[i.name]);this.loaded_tiles=[]}return c.prototype.remove=function(){return this.map.remove(),this.biomeTiles.remove()},c.prototype.map_coords=function(a){return this.map.options.crs.pointToLatLng({x:a.x/8,y:a.y/8},this.biomeTiles.layer.options.nativeZoom)},c.prototype.mc_coords=function(a){var b;return b=this.map.options.crs.latLngToPoint(a,this.biomeTiles.layer.options.nativeZoom),b.x*=8,b.y*=8,b},c.prototype.tileCoords=function(a){return{c_x:a.x>>11,c_y:a.y>>11}},c.prototype.mcCoordsFromTile=function(a){return{x:2048*a.x,y:2048*a.y}},c.prototype.biomeAt=function(a){var b,c,d,e,f,g;return e=this.tileCoords(a),c=this.biomeTiles.cache.get(e),f=(a.x>>2)-512*e.c_x,g=(a.y>>2)-512*e.c_y,c?(b=c[0],d=c[1],window.biome_map[b[f+3+518*(g+3)]]):null},c.prototype.biomeAtBiomeCoords=function(a,b){var c,d,e,f;return f={c_x:a>>9,c_y:b>>9},d=this.biomeTiles.cache.get(f),a-=512*f.c_x,b-=512*f.c_y,d?(c=d[0],e=d[1],window.biome_map[c[a+3+518*(b+3)]]):null},c.prototype.setStaticFeature=function(a,b){var c,d,e,f;for(this.markers[a].clearLayers(),e=0,f=b.length;f>e;e++)d=b[e],c=this.feature_makers[a](d),c.addTo(this.markers[a])},c.prototype.addTileFeature=function(a,b){var c;return a=a.tile,a.feature_layers||(a.feature_layers={}),c=function(c){return function(d,e){var f,g,h,i,j;if(d)return void console.log("Err in feature get");for(g=L.layerGroup(),j=e[b]||[],h=0,i=j.length;i>h;h++)f=j[h],c.feature_makers[b](f).addTo(g);return g.addTo(c.markers[b]),a.feature_layers[b]=g}}(this),"Slime Chunks"===b?this.slimeCache.get(a.coords,c):this.featureCache.get(a.coords,c)},c.prototype.removeTileFeature=function(a,b){var c;return a=a.tile,(null!=(c=a.feature_layers)?c[b]:void 0)?this.markers[b].removeLayer(a.feature_layers[b]):void 0},c.prototype.tileLoad=function(a){var c,d,e;this.loaded_tiles.push(a),e=this.feature_layer_state;for(c in e)d=e[c],b.call(this.static_features,c)<0&&d&&this.addTileFeature(a,c)},c.prototype.tileUnload=function(a){var c,d,e;this.loaded_tiles=_.without(this.loaded_tiles,a),e=this.feature_layer_state;for(c in e)d=e[c],b.call(this.static_features,c)<0&&d&&this.removeTileFeature(a,c)},c.prototype.setLayerState=function(a,c){var d,e,f,g,h,i;if(b.call(this.static_features,a)>=0)return void(c?this.map.addLayer(this.markers[a]):this.map.removeLayer(this.markers[a]));if(d=this.feature_layer_state[a],this.feature_layer_state[a]=c,d!==c){for(h=this.loaded_tiles,i=[],f=0,g=h.length;g>f;f++)e=h[f],i.push(c?this.addTileFeature(e,a):this.removeTileFeature(e,a));return i}},c.prototype.checkBiomeRegion=function(a,b,c){var d,e,f,g,h,i,j,k,l;for(f=a.x-b>>2,e=a.y-b>>2,g=a.x+b>>2,h=a.y+b>>2,i=k=f;g>=f?g>=k:k>=g;i=g>=f?++k:--k)for(j=l=h;e>=h?e>=l:l>=e;j=e>=h?++l:--l){if(d=this.biomeAtBiomeCoords(i,j),!d)return!1;if(!d[c])return!1}return!0},c.prototype.featureProvider=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(console.time("Feature"+a),i={},n=32,p=this.mcCoordsFromTile(a),d={x:p.x+2048,y:p.y+2048},h={top:Math.floor(p.y/(16*n)),left:Math.floor(p.x/(16*n)),bottom:Math.floor(d.y/(16*n))-1,right:Math.floor(d.x/(16*n))-1},f=r=t=h.top,u=h.bottom;u>=t?u>=r:r>=u;f=u>=t?++r:--r)for(e=s=v=h.left,w=h.right;w>=v?w>=s:s>=w;e=w>=v?++s:--s)m=8,l=Long.fromNumber(e).multiply(341873128712).add(Long.fromNumber(f).multiply(132897987541)).add(this.seed),q=l.add(10387312),k=new JavaRand(q),g={x:16*(32*e+k.nextInt(n-m))+8,y:16*(32*f+k.nextInt(n-m))+8},this.biomeAt(g).village&&(i["Likely Villages"]||(i["Likely Villages"]=[])).push(g),o=l.add(14357617),k=new JavaRand(o),g={x:16*(32*e+k.nextInt(n-m))+8,y:16*(32*f+k.nextInt(n-m))+8},c=this.biomeAt(g),c.witch_hut?(i["Witch Huts"]||(i["Witch Huts"]=[])).push(g):c.jungle_temple?(i["Jungle Temples"]||(i["Jungle Temples"]=[])).push(g):c.desert_temple&&(i["Desert Temples"]||(i["Desert Temples"]=[])).push(g),j=l.add(10387313),m=5,k=new JavaRand(j),g={x:16*(32*e+~~((k.nextInt(n-m)+k.nextInt(n-m))/2))+8,y:16*(32*f+~~((k.nextInt(n-m)+k.nextInt(n-m))/2))+8},this.biomeAt(g).monument&&this.checkBiomeRegion(g,29,"aquatic")&&(i["Ocean Monuments"]||(i["Ocean Monuments"]=[])).push(g);return console.timeEnd("Feature"+a),b(null,i)},c.prototype.slimeProvider=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;for(p=[],console.time("Slime"),q=this.mcCoordsFromTile(a),c={x:q.x+2048,y:q.y+2048},f={top:q.y>>4,left:q.x>>4,bottom:(c.y>>4)-1,right:(c.x>>4)-1},r=[],d=t=w=f.left,x=f.right;x>=w?x>=t:t>=x;d=x>=w?++t:--t)h=Long.fromNumber(d),i=Long.fromInt(h.multiply(h).multiply(4987142).getLowBits()),j=h.multiply(5947611).getLowBits(),r[d-f.left]=i.add(j);for(e=u=y=f.top,z=f.bottom;z>=y?z>=u:u>=z;e=z>=y?++u:--u)for(k=Long.fromNumber(e),l=Long.fromInt(k.multiply(k).getLowBits()).multiply(4392871),m=k.multiply(389711).getLowBits(),s=l.add(m),d=v=A=f.left,B=f.right;B>=A?B>=v:v>=B;d=B>=A?++v:--v)o=this.seed.add(r[d-f.left]).add(s).xor(987234911),n=new JavaRand(o),0===n.nextInt(10)&&(g={x:16*d,y:16*e},p.push(g));return console.timeEnd("Slime"),b(null,{"Slime Chunks":p})},c}()}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};window.MapView=function(b){function d(){return this.randomSeed=a(this.randomSeed,this),this.updateFromFile=a(this.updateFromFile,this),this.setFile=a(this.setFile,this),this.setSeedFromText=a(this.setSeedFromText,this),this.render=a(this.render,this),this.setLocation=a(this.setLocation,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.initialize=function(){var a,b,c,d,e,f,g;for(this.$el.empty(),this.$seedInputEl=$($("#seed-input-template").html()),this.$el.append(this.$seedInputEl),this.mapEl=$("<div class='leaflet-map'></div>"),this.$el.append(this.mapEl),this.render(),c=function(a){return function(){var b;return b=Math.min(a.$el.width(),Math.max($(window).height()-a.$el.position().top-10,a.$seedInputEl.height()+30)),a.$el.height(b),a.$seedInputEl.css("padding-top",(b-a.$seedInputEl.height())/2)}}(this),$(window).resize(c),c(),this.model.on({"change:seed":this.render,"change:pos.* change:dir.*":function(a){return function(){var b,c;return null!=a.map&&(c=a.model.get("pos"),b=a.model.get("dir"),null!=c)?(a.model.set("features.0.disabled",!1),a.map.setStaticFeature("Player",[c])):void 0}}(this),"change:mapCentreX change:mapCentreY change:mapZoom":function(a){return function(){var b;return a.supress_event?void 0:null!=(b=a.map)?b.map.setView(a.map.map_coords({x:a.model.get("mapCentreX"),y:a.model.get("mapCentreY")}),a.model.get("mapZoom")):void 0}}(this)}),f=this.model.get("features"),g=[],b=d=0,e=f.length;e>d;b=++d)a=f[b],g.push(function(a){return function(b,c){return a.model.on("change:features."+c+".active",function(){return a.map?a.map.setLayerState(b.name,a.model.get("features."+c+".active")):void 0})}}(this)(a,b));return g},d.prototype.setLocation=function(a){var b;return a?(b=this.map.mc_coords(a),this.model.set({mouse:b,mouse_biome:this.map.biomeAt(b)})):this.model.set({mouse:null,mouse_biome:null})},d.prototype.render=function(){var a;return a=this.model.get("seed"),null!=a&&a?(this.$seedInputEl.hide(),this.mapEl.show()):(this.timeoutId&&clearTimeout(this.timeoutId),this.mapEl.hide(),this.$seedInputEl.show()),null!=this.map&&(this.map.remove(),this.map=void 0),null!=a&&a?(this.map=new MineMap(this.mapEl,Long.fromString(a),this.model.get("features"),this.model.get("mapCentreX"),this.model.get("mapCentreY"),this.model.get("mapZoom")),this.map.map.on("click",function(a){return function(b){return a.setLocation(b.latlng)}}(this)),this.map.map.on("mousemove",function(a){return function(b){return a.setLocation(b.latlng)}}(this)),this.map.map.on("mouseout",function(a){return function(){return a.setLocation(null)}}(this)),this.map.map.on("moveend zoomend",function(a){return function(){var b;return b=a.map.mc_coords(a.map.map.getCenter()),a.supress_event=!0,a.model.set({mapCentreX:b.x,mapCentreY:b.y,mapZoom:a.map.map.getZoom()}),a.supress_event=!1}}(this))):void 0},d.prototype.stringHashCode=function(a){var b,c,d,e,f;if(c=0,0===a.length)return c;for(d=e=0,f=a.length;f>=0?f>e:e>f;d=f>=0?++e:--e)b=a.charCodeAt(d),c=(c<<5)-c+b,c&=c;return c},d.prototype.setSeedFromText=function(){var a,b,c;return c=this.$(".seed-in").val(),c.match(/^[-+]?\d+$/)?(a=c,b=Long.fromString(c)):(a=c,b=Long.fromNumber(this.stringHashCode(c))),this.model.set({levelName:a,seed:b.toString()})},d.prototype.setFile=function(a){return this.levelFile=a.target.files[0],this.updateFromFile()},d.prototype.updateFromFile=function(){var a;return a=new FileReader,a.onload=function(b){return function(){return nbt.parse(a.result,function(a,c){return b.model.set({seed:c.Data.RandomSeed.toString(),pos:{x:c.Data.Player.Pos[0],y:c.Data.Player.Pos[2]},dir:c.Data.Player.Rotation,levelName:c.Data.LevelName}),b.timeoutId=setTimeout(b.updateFromFile,1e3)})}}(this),a.readAsBinaryString(this.levelFile)},d.prototype.randomSeed=function(){var a,b,c;for(b="",a=c=0;15>c;a=++c)b+=Math.floor(10*Math.random());return Math.random()<.5&&(b="-"+b),this.model.set({levelName:"Random",seed:b})},d.prototype.events={"click .text-seed":"setSeedFromText","change .level-file":"setFile","click .random-seed":"randomSeed"},d}(Backbone.View)}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};window.MapInfoView=function(b){function d(){return this.toggleFeature=a(this.toggleFeature,this),this.newMap=a(this.newMap,this),this.render=a(this.render,this),d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.initialize=function(){return this.template=_.template($("#mapinfo-template").html()),this.clip=new ZeroClipboard,this.render(),this.model.on({change:this.render})},d.prototype.render=function(){var a;return a=this.model.toJSON(),this.$el.html(this.template(a)),!this.model.get("ZCdisable")&&(this.clip.unclip(),document.getElementById("clipboard"))?this.clip.clip(document.getElementById("clipboard")):void 0},d.prototype.newMap=function(){return this.model.set({seed:!1,levelName:!1})},d.prototype.toggleFeature=function(a){var b,c,d,e,f,g,h;for(c=this.model.get("features"),d=g=0,h=c.length;h>g;d=++g)b=c[d],b.name===a.currentTarget.id.replace("_"," ")&&(e=d);return f="features."+e+".active",this.model.set(f,!this.model.get(f))},d.prototype.events={"click .new-map > button":"newMap","click .feature-toggle":"toggleFeature"},d}(Backbone.View)}.call(this),function(){var a,b,c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};L.Icon.Default.imagePath="/styles/images",a=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.defaults={features:[{name:"Player",icon:"player.png",active:!0},{name:"Likely Villages",icon:"village.png",active:!0},{name:"Ocean Monuments",icon:"ocean.png",active:!0},{name:"Jungle Temples",icon:"chest.png",active:!1},{name:"Desert Temples",icon:"chest.png",active:!1},{name:"Witch Huts",icon:"witch.png",active:!1},{name:"Slime Chunks",icon:"slime.png",active:!1}],mapCentreX:0,mapCentreY:0,mapZoom:16},b}(Backbone.DeepModel),f=function(a){var b,c,d,e,f,g;for(d=a.get("seed"),c={levelName:a.get("levelName"),seed:d,mapCentreX:a.get("mapCentreX"),mapCentreY:a.get("mapCentreY"),mapZoom:a.get("mapZoom"),pos:a.get("pos")},g=a.get("features"),e=0,f=g.length;f>e;e++)b=g[e],null!=b.active&&(c[b.name]=b.active);return null!=d&&d?"/?"+$.param(c):"/"},g=!1,b=function(a,b){var c,d,e,f,h,i,j,k,l;for(c=$.deparam(b),e={levelName:c.levelName||"NoName",seed:c.seed,mapCentreX:parseInt(c.mapCentreX||0),mapCentreY:parseInt(c.mapCentreY||0),mapZoom:parseInt(c.mapZoom||16),features:[]},f=!0,c.pos&&(h=parseFloat(c.pos.x),i=parseFloat(c.pos.y),!isNaN(h)&&isFinite(h)&&!isNaN(i)&&isFinite(i)&&(e.pos={x:h,y:i},f=!1)),l=a.get("features"),j=0,k=l.length;k>j;j++)d=l[j],null!=c[d.name]&&(d.active="true"===c[d.name]),"Player"===d.name&&(d.disabled=f),e.features.push(d);return g=!0,a.set(e),g=!1},d=new a,window.map_state=d,e=new MapView({model:d,el:".minemap"}),c=new MapInfoView({model:d,el:".mapinfo"}),b(d,window.location.search.substring(1)),d.on("change",function(){var a;return g||(d.hasChanged("seed")?window.history.pushState({},"MineAtlas",f(d)):window.history.replaceState({},"MineAtlas",f(d))),this.model.get("ZCdisable")?null!=(a=document.getElementById("clipboard"))?a.href=window.location.href:void 0:ZeroClipboard.setData("text/plain",window.location.href)}),window.onpopstate=function(){return b(d,document.location.search.substring(1))},ZeroClipboard.setData("text/plain",window.location.href),ZeroClipboard.on("error",function(){return d.set("ZCdisable",!0)})}.call(this);